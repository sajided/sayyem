(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{4050:(e,a,t)=>{Promise.resolve().then(t.bind(t,9915))},6635:(e,a,t)=>{"use strict";t.d(a,{ToastProvider:()=>l,d:()=>i});var r=t(5155),d=t(2115);let s=(0,d.createContext)(null);function l(e){let{children:a}=e,[t,l]=(0,d.useState)([]),i=(0,d.useCallback)(function(e){var a;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Math.random().toString(36).slice(2),d={id:r,message:e,duration:null!=(a=t.duration)?a:1800};l(e=>[...e,d]),setTimeout(()=>{l(e=>e.filter(e=>e.id!==r))},d.duration)},[]);return(0,r.jsx)(s.Provider,{value:{show:i,toasts:t,setToasts:l},children:a})}let i=()=>(0,d.useContext)(s)},9915:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>o});var r=t(5155),d=t(2115),s=t(6635);function l(e){let{title:a,children:t}=e;return(0,r.jsxs)("section",{className:"rounded-2xl border border-black/10 p-4 dark:border-white/10",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:a}),(0,r.jsx)("div",{className:"mt-3",children:t})]})}function i(){let e=(0,s.d)(),[a,t]=(0,d.useState)([]);async function l(){let e=await fetch("/api/admin/coupons");t((await e.json()).coupons||[])}async function i(a){a.preventDefault();let t=a.currentTarget,r=new FormData(t),d={code:r.get("code"),type:r.get("type"),amount:Number(r.get("amount")),active:"on"===r.get("active"),expiresAt:r.get("expiresAt")||null};e.show("Creating coupon…",{duration:1e3}),(await fetch("/api/admin/coupons",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok?(t.reset(),e.show("Coupon created"),l()):e.show("Failed to create coupon")}async function n(a,t){e.show(t?"Enabling coupon…":"Disabling coupon…",{duration:800}),(await fetch("/api/admin/coupons/".concat(a),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})})).ok?e.show(t?"Coupon enabled":"Coupon disabled"):e.show("Failed to update coupon"),l()}async function o(a){confirm("Delete coupon?")&&(e.show("Deleting coupon…",{duration:800}),(await fetch("/api/admin/coupons/".concat(a),{method:"DELETE"})).ok?e.show("Coupon deleted"):e.show("Failed to delete coupon"),l())}return(0,d.useEffect)(()=>{l()},[]),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("form",{onSubmit:i,className:"grid gap-2 rounded-2xl border p-4 dark:border-white/10",children:[(0,r.jsx)("h3",{className:"font-medium",children:"Create coupon"}),(0,r.jsx)("input",{name:"code",required:!0,placeholder:"CODE (e.g. RUSH50)",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("select",{name:"type",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:[(0,r.jsx)("option",{value:"percent",children:"% off"}),(0,r.jsx)("option",{value:"fixed",children:"৳ off"})]}),(0,r.jsx)("input",{name:"amount",type:"number",step:"1",min:"1",placeholder:"Amount",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("input",{name:"active",type:"checkbox",defaultChecked:!0})," Active"]}),(0,r.jsx)("input",{name:"expiresAt",type:"date",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"})]}),(0,r.jsx)("button",{className:"rounded-xl border border-black/10 bg-black px-4 py-2 text-sm font-medium text-white dark:border-white/10 dark:bg-white dark:text-black",children:"Create"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[a.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-xl border p-3 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.code}),(0,r.jsxs)("div",{className:"text-xs text-neutral-600 dark:text-neutral-400",children:["percent"===e.type?"".concat(e.amount,"% off"):"৳".concat(e.amount," off")," ",e.expiresAt?"• expires ".concat(new Date(e.expiresAt).toLocaleDateString()):""]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>n(e._id,!e.active),className:"rounded-lg border px-3 py-1 text-xs",children:e.active?"Disable":"Enable"}),(0,r.jsx)("button",{onClick:()=>o(e._id),className:"rounded-lg border px-3 py-1 text-xs",children:"Delete"})]})]},e._id)),0===a.length&&(0,r.jsx)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"No coupons yet."})]})]})}function n(e){let{p:a,cats:t,onClose:l,onSaved:i}=e,n=(0,s.d)(),[o,c]=(0,d.useState)(a.name),[b,u]=(0,d.useState)(a.slug),[m,p]=(0,d.useState)(a.regularPrice||0),[x,h]=(0,d.useState)(a.salePrice||0),[g,k]=(0,d.useState)(a.category||""),[w,f]=(0,d.useState)(a.quantity||0),[j,y]=(0,d.useState)(!!a.soldOut),[N,v]=(0,d.useState)(!!a.hot),[C,S]=(0,d.useState)(a.description||""),[T,D]=(0,d.useState)(a.images||[]);async function E(e){var t;e.preventDefault();let r=null==(t=e.currentTarget.images)?void 0:t.files,d=[...T];if(r&&r.length){n.show("Uploading images…",{duration:1200});let e=new FormData;Array.from(r).forEach(a=>e.append("files",a));let a=await fetch("/api/admin/upload",{method:"POST",body:e}),t=await a.json();if(!a.ok||!t.paths){n.show("Image upload failed"),console.error("upload error",t);return}d=d.concat(t.paths||[]),n.show("Images uploaded")}n.show("Saving product…",{duration:1e3});let s={name:o,slug:b,price:Number(x||m||a.price||0),regularPrice:Number(m||0),salePrice:Number(x||0),category:g,quantity:Number(w||0),soldOut:j,hot:N,description:C,images:d};(await fetch("/api/admin/products/".concat(a._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?(n.show("Product saved"),null==i||i(),null==l||l()):n.show("Failed to save")}async function O(){confirm("Delete this product?")&&(n.show("Deleting product…",{duration:900}),(await fetch("/api/admin/products/".concat(a._id),{method:"DELETE"})).ok?(n.show("Product deleted"),null==i||i(),null==l||l()):n.show("Failed to delete"))}return(0,r.jsxs)("div",{className:"fixed inset-0 z-[95]",children:[(0,r.jsx)("div",{onClick:l,className:"absolute inset-0 bg-black/40"}),(0,r.jsxs)("div",{className:"absolute right-0 top-0 h-full w-full max-w-lg overflow-y-auto bg-white p-4 dark:bg-neutral-900",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Edit product"}),(0,r.jsxs)("form",{onSubmit:E,className:"mt-3 grid gap-2",children:[(0,r.jsx)("input",{value:o,onChange:e=>c(e.target.value),placeholder:"Name",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{value:b,onChange:e=>u(e.target.value),placeholder:"Slug",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)("input",{value:m,onChange:e=>p(e.target.value),type:"number",placeholder:"Regular Price",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{value:x,onChange:e=>h(e.target.value),type:"number",placeholder:"Sale Price",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"})]}),(0,r.jsxs)("select",{value:g,onChange:e=>k(e.target.value),className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:[(0,r.jsx)("option",{value:"",children:"Select category"}),(t||[]).map(e=>(0,r.jsxs)("option",{value:e.slug,children:[e.name," (",e.slug,")"]},e._id))]}),(0,r.jsx)("input",{value:w,onChange:e=>f(e.target.value),type:"number",placeholder:"Available quantity",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("textarea",{value:C,onChange:e=>S(e.target.value),placeholder:"Description",className:"min-h-[100px] rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("div",{className:"text-xs",children:"Add more images"}),(0,r.jsx)("input",{name:"images",type:"file",multiple:!0,accept:"image/*",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:T.map((e,a)=>(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:e,className:"h-16 w-16 rounded object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>removeImage(a),title:"Remove image",className:"absolute -right-2 -top-2 grid h-6 w-6 place-items-center rounded-full border border-black/10 bg-white text-xs shadow hover:bg-red-50 dark:border-white/10 dark:bg-neutral-800",children:"\xd7"})]},a))}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:j,onChange:e=>y(e.target.checked)})," Sold out"]}),(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:N,onChange:e=>v(e.target.checked)})," Hot"]})]}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,r.jsx)("button",{className:"rounded-xl border border-black/10 bg-black px-4 py-2 text-sm font-medium text-white dark:border-white/10 dark:bg-white dark:text-black",children:"Save"}),(0,r.jsx)("button",{type:"button",onClick:O,className:"rounded-xl border border-black/10 bg-white px-4 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:"Delete"}),(0,r.jsx)("button",{type:"button",onClick:l,className:"ml-auto rounded-xl border border-black/10 bg-white px-4 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:"Close"})]})]})]})]})}function o(){let e=(0,s.d)();async function a(a){var t;a.preventDefault();let r=a.currentTarget,d=new FormData(r),s=d.get("name"),l=d.get("slug"),i=Number(d.get("regularPrice")||0),n=Number(d.get("salePrice")||0),o=d.get("category")||"",c=Number(d.get("quantity")||0),b=d.get("description")||"",u="on"===d.get("soldOut"),m="on"===d.get("hot"),p=d.get("seoTitle")||"",x=d.get("seoDescription")||"",g=d.get("seoKeywords")||"",k=d.get("seoOgImage")||"",w=d.get("seoCanonical")||"",f="on"===d.get("seoNoindex"),j=[],y=null==(t=r.images)?void 0:t.files;if(y&&y.length){e.show("Uploading images…",{duration:1200});let a=new FormData;Array.from(y).forEach(e=>a.append("files",e));let t=await fetch("/api/admin/upload",{method:"POST",body:a}),r=await t.json();if(!t.ok||!r.paths){e.show("Image upload failed"),console.error("upload error",r);return}j=r.paths||[],e.show("Images uploaded")}e.show("Creating product…",{duration:1e3});let N={name:s,slug:l,regularPrice:i,salePrice:n,price:n||i,category:o,quantity:c,description:b,soldOut:u,hot:m,images:j},v=await fetch("/api/admin/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(v.ok){await v.json(),e.show("Product created");try{let e={path:"/product/".concat(l),title:p||s,description:x||(null==b?void 0:b.slice(0,160))||"",keywords:g,ogImage:k||j&&j[0]||"",noindex:f,canonical:w};(e.title||e.description||e.keywords||e.ogImage||e.noindex||e.canonical)&&await fetch("/api/admin/seo-meta",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.warn("SEO create failed",e)}r.reset(),h()}else e.show("Failed to create product")}let[t,o]=(0,d.useState)([]),[c,b]=(0,d.useState)(null);async function h(){let e=await fetch("/api/products?limit=100");o((await e.json()).items||[])}(0,d.useEffect)(()=>{h()},[]);let[g,k]=(0,d.useState)([]);async function w(){let e=await fetch("/api/categories");k((await e.json()).categories||[])}async function f(a){var t,r,d;a.preventDefault();let s=a.currentTarget,l=new FormData(s),i={name:l.get("name"),slug:l.get("slug"),featured:"on"===l.get("featured")},n=null==(r=s.image)||null==(t=r.files)?void 0:t[0];if(n){let e=new FormData;e.append("files",n);let a=await fetch("/api/admin/upload",{method:"POST",body:e}),t=await a.json();a.ok&&(null==(d=t.paths)?void 0:d.length)?i.image=t.paths[0]:console.error("upload failed",t)}(await fetch("/api/admin/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok?(s.reset(),e.show("Category created"),w()):e.show("Failed to create category")}async function j(a){confirm("Delete category?")&&((await fetch("/api/admin/categories/".concat(a),{method:"DELETE"})).ok?(e.show("Category deleted"),w()):e.show("Failed to delete category"))}async function y(a,t){(await fetch("/api/admin/categories/".concat(a._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({featured:t})})).ok?(e.show("Updated"),w()):e.show("Failed to update")}async function N(a,t){if(t)try{var r;let d=new FormData;d.append("files",t);let s=await fetch("/api/admin/upload",{method:"POST",body:d}),l=(null==(r=(await s.json()).paths)?void 0:r[0])||"";if(!s.ok||!l)throw Error("Upload failed");await fetch("/api/admin/categories/".concat(a),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:l})}),e.show("Category image updated"),w()}catch(a){console.error(a),e.show("Failed to update image")}}(0,d.useEffect)(()=>{w()},[]);let[v,C]=(0,d.useState)([]),[S,T]=(0,d.useState)({siteTitle:"",defaultDescription:"",defaultKeywords:"",ogImage:"",twitterHandle:"",canonicalBase:""}),[D,E]=(0,d.useState)([]),[O,P]=(0,d.useState)(!1),[F,I]=(0,d.useState)(null),[A,_]=(0,d.useState)(null),[U,L]=(0,d.useState)(!1);async function V(){let e=await fetch("/api/admin/orders");C((await e.json()).orders||[])}async function q(a,t){try{(await fetch("/api/admin/orders/".concat(a._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentStatus:t})})).ok?(e.show("Status updated"),V()):e.show("Failed to update status")}catch(a){e.show("Failed to update status")}}async function M(a){if(confirm("Delete this order? This cannot be undone."))try{if(!(await fetch("/api/admin/orders/".concat(a._id),{method:"DELETE"})).ok)return void e.show("Failed to delete");e.show("Order deleted"),V()}catch(a){e.show("Failed to delete")}}async function J(a){a.preventDefault();let t=new FormData(a.currentTarget),r={name:t.get("name")||"",phone:t.get("phone")||"",address:t.get("address")||"",city:t.get("city")||"Dhaka",delivery:t.get("delivery")||"inside",payment:t.get("payment")||"cod",note:t.get("note")||""};try{if(!(await fetch("/api/admin/orders/".concat(A._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)return void e.show("Failed to update order");e.show("Order updated"),L(!1),_(null),V()}catch(a){e.show("Failed to update order")}}async function R(){try{let e=await fetch("/api/admin/site-settings"),a=await fetch("/api/admin/seo-meta"),t=await e.json(),r=await a.json();(null==t?void 0:t.settings)&&T(t.settings),(null==r?void 0:r.entries)&&E(r.entries)}catch(e){}}async function H(a){a.preventDefault();let t=new FormData(a.currentTarget),r={siteTitle:t.get("siteTitle")||"",defaultDescription:t.get("defaultDescription")||"",defaultKeywords:t.get("defaultKeywords")||"",ogImage:t.get("ogImage")||"",twitterHandle:t.get("twitterHandle")||"",canonicalBase:t.get("canonicalBase")||"",gaMeasurementId:t.get("gaMeasurementId")||"",gtmContainerId:t.get("gtmContainerId")||"",analyticsEnabled:"on"===t.get("analyticsEnabled")};(await fetch("/api/admin/site-settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok?(e.show("Site metadata saved"),R()):e.show("Failed to save site metadata")}function X(e){I(e||null),P(!0)}async function K(a){a.preventDefault();let t=new FormData(a.currentTarget),r={path:t.get("path")||"",title:t.get("title")||"",description:t.get("description")||"",keywords:t.get("keywords")||"",ogImage:t.get("ogImage")||"",noindex:"on"===t.get("noindex"),canonical:t.get("canonical")||""},d=F?"/api/admin/seo-meta/".concat(F._id):"/api/admin/seo-meta",s=F?"PUT":"POST";(await fetch(d,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok?(e.show(F?"SEO entry updated":"SEO entry added"),P(!1),I(null),R()):e.show("Failed to save SEO entry")}async function G(a){confirm("Delete this SEO entry?")&&((await fetch("/api/admin/seo-meta/".concat(a._id),{method:"DELETE"})).ok?(e.show("SEO entry deleted"),R()):e.show("Failed to delete"))}return(0,d.useEffect)(()=>{V()},[]),(0,d.useEffect)(()=>{R()},[]),(0,r.jsxs)("div",{className:"container py-8 space-y-8",children:[(0,r.jsx)(u,{}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:"Admin Panel"}),(0,r.jsx)("button",{className:"rounded-xl border border-black/10 bg-white px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60",onClick:async()=>{try{await fetch("/api/admin/logout",{method:"POST"})}catch(e){}window.location.href="/"},children:"Logout"})]}),(0,r.jsx)(l,{title:"Add Product",children:(0,r.jsxs)("form",{onSubmit:a,className:"grid gap-2 md:grid-cols-2",children:[(0,r.jsx)("input",{name:"name",required:!0,placeholder:"Name",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"slug",required:!0,placeholder:"Slug (unique)",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"regularPrice",type:"number",step:"1",placeholder:"Regular Price (৳)",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"salePrice",type:"number",step:"1",placeholder:"Sale Price (৳)",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("select",{name:"category",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:[(0,r.jsx)("option",{value:"",children:"Select category"}),g.map(e=>(0,r.jsxs)("option",{value:e.slug,children:[e.name," (",e.slug,")"]},e._id))]}),(0,r.jsx)("input",{name:"quantity",type:"number",step:"1",placeholder:"Available quantity",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("p",{className:"text-xs mb-1",children:"Images (you can select multiple files)"}),(0,r.jsx)("input",{name:"images",type:"file",multiple:!0,accept:"image/*",className:"w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"})]}),(0,r.jsx)("textarea",{name:"description",placeholder:"Description",className:"col-span-2 min-h-[100px] rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("div",{className:"col-span-2 flex items-center gap-4 text-sm",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",name:"soldOut"})," Mark sold out"]}),(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",name:"hot"})," Mark as hot"]})]}),(0,r.jsxs)("div",{className:"col-span-2 mt-2 rounded-xl border border-black/10 p-3 text-sm dark:border-white/10",children:[(0,r.jsx)("p",{className:"mb-2 font-medium",children:"SEO (optional)"}),(0,r.jsx)("input",{name:"seoTitle",placeholder:"SEO Title (optional)",className:"mb-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("textarea",{name:"seoDescription",placeholder:"SEO Description (optional)",className:"mb-2 h-20 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"seoKeywords",placeholder:"SEO Keywords (comma separated)",className:"mb-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"seoOgImage",placeholder:"OG Image URL (optional)",className:"mb-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)("input",{name:"seoCanonical",placeholder:"Canonical URL (optional)",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)("input",{type:"checkbox",name:"seoNoindex"})," Noindex"]})]})]}),(0,r.jsx)("button",{className:"col-span-2 rounded-xl border border-black/10 bg-black px-4 py-2 text-sm font-medium text-white dark:border-white/10 dark:bg-white dark:text-black",children:"Create"})]})}),(0,r.jsxs)(l,{title:"Manage Products",children:[(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:t.map(e=>{var a;return(0,r.jsxs)("button",{onClick:()=>b(e),className:"text-left overflow-hidden rounded-2xl border border-black/10 bg-white hover:shadow-md dark:border-white/10 dark:bg-neutral-900",children:[(0,r.jsx)("img",{src:(null==(a=e.images)?void 0:a[0])||"https://i.ibb.co.com/Z1Wqp1m7/85483964-mario1.jpg",className:"aspect-square w-full object-cover"}),(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsx)("div",{className:"line-clamp-1 text-sm font-medium",children:e.name}),(0,r.jsx)("div",{className:"text-xs text-neutral-600 dark:text-neutral-400",children:e.salePrice>0?(0,r.jsxs)(r.Fragment,{children:["৳",e.salePrice," ",(0,r.jsxs)("span",{className:"line-through",children:["৳",e.regularPrice||e.price]})]}):(0,r.jsxs)(r.Fragment,{children:["৳",e.price||e.regularPrice]})})]})]},e._id)})}),c&&(0,r.jsx)(n,{p:c,cats:g,onClose:()=>b(null),onSaved:()=>{b(null),h()}})]}),(0,r.jsxs)(l,{title:"Categories",children:[(0,r.jsxs)("form",{onSubmit:f,className:"grid max-w-md grid-cols-2 gap-2",children:[(0,r.jsx)("input",{name:"name",required:!0,placeholder:"Name",className:"rounded-xl border border-black/10 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"slug",required:!0,placeholder:"Slug",className:"rounded-xl border border-black/10 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("label",{className:"col-span-2 flex items-center gap-2 text-sm",children:[(0,r.jsx)("input",{name:"featured",type:"checkbox"})," Featured"]}),(0,r.jsx)("input",{name:"image",type:"file",accept:"image/*",className:"col-span-2 rounded-xl border border-black/10 file:mr-3 file:rounded-lg file:border file:px-3 file:py-1 file:text-xs dark:border-white/10"}),(0,r.jsx)("button",{className:"col-span-2 rounded-xl border border-black/10 bg-white px-4 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:"Add Category"})]}),(0,r.jsx)("div",{className:"mt-4 grid grid-cols-1 gap-2 md:grid-cols-2",children:g.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-xl border p-3 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[e.image?(0,r.jsx)("img",{src:e.image,alt:"",className:"h-12 w-12 rounded-lg object-cover"}):(0,r.jsx)("div",{className:"h-12 w-12 rounded-lg bg-neutral-200 dark:bg-neutral-800"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-neutral-600 dark:text-neutral-400",children:[e.slug," ",e.featured?"• Featured":""]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("label",{className:"text-xs cursor-pointer rounded-lg border px-3 py-1",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>{var t;return N(e._id,null==(t=a.currentTarget.files)?void 0:t[0])}}),"Upload image"]}),(0,r.jsx)("button",{onClick:()=>y(e,!e.featured),className:"rounded-lg border px-3 py-1 text-xs",children:e.featured?"Unfeature":"Feature"}),(0,r.jsx)("button",{onClick:()=>j(e._id),className:"rounded-lg border px-3 py-1 text-xs",children:"Delete"})]})]},e._id))})]}),(0,r.jsx)(l,{title:"Manage Coupons",children:(0,r.jsx)(i,{})}),(0,r.jsx)(l,{title:"Orders",children:(0,r.jsx)("div",{className:"grid gap-2",children:v.map(e=>(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"font-medium",children:["Order ",e._id.slice(-6)]}),(0,r.jsxs)("select",{value:e.currentStatus,onChange:a=>q(e,a.currentTarget.value),className:"rounded-lg border px-2 py-1 text-sm",children:[(0,r.jsx)("option",{value:"Pending",children:"Pending"}),(0,r.jsx)("option",{value:"Processing",children:"Processing"}),(0,r.jsx)("option",{value:"Shipped",children:"Shipped"}),(0,r.jsx)("option",{value:"Delivered",children:"Delivered"}),(0,r.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,r.jsxs)("p",{className:"mt-1 text-sm",children:["Customer: ",e.name," • ",e.phone]}),(0,r.jsxs)("p",{className:"mt-1 text-sm",children:[e.address,", ",e.city]}),e.note&&(0,r.jsxs)("p",{className:"mt-1 text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"Special note:"})," ",e.note]}),(0,r.jsxs)("p",{className:"mt-1 text-sm",children:["Delivery: ","inside"===e.delivery?"Inside Dhaka (৳60)":"Outside Dhaka (৳100)"," • Payment: Cash on delivery"]}),e.giftWrap&&(0,r.jsx)("p",{className:"mt-1 text-sm",children:"Gift wrap: Yes (৳50)"}),(0,r.jsx)("div",{className:"mt-2 text-sm",children:e.items.map((e,a)=>(0,r.jsxs)("div",{children:["• ",e.name," \xd7 ",e.qty," — ৳",e.price]},a))}),(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[(0,r.jsx)("button",{className:"rounded-lg border border-black/10 px-2 py-1 dark:border-white/10",onClick:()=>{_(e),L(!0)},children:"Edit"}),(0,r.jsx)("button",{className:"rounded-lg border border-red-600/40 px-2 py-1 text-red-600",onClick:()=>M(e),children:"Delete"})]})]},e._id))})}),(0,r.jsx)(l,{title:"Reviews",children:(0,r.jsx)(p,{})}),(0,r.jsx)(l,{title:"Questions & Answers",children:(0,r.jsx)(x,{})}),U&&A&&(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>{L(!1),_(null)},"aria-hidden":"true"}),(0,r.jsxs)("div",{role:"dialog","aria-modal":"true",className:"relative w-[92%] max-w-lg rounded-2xl border border-black/10 bg-white p-5 shadow-2xl dark:border-white/10 dark:bg-neutral-900",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Order"}),(0,r.jsxs)("form",{onSubmit:J,className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[(0,r.jsx)("input",{name:"name",defaultValue:A.name||"",placeholder:"Name",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"phone",defaultValue:A.phone||"",placeholder:"Phone (+88...)",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"address",defaultValue:A.address||"",placeholder:"Address",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"city",defaultValue:A.city||"Dhaka",placeholder:"City",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("select",{name:"delivery",defaultValue:A.delivery||"inside",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60",children:[(0,r.jsx)("option",{value:"inside",children:"Inside Dhaka"}),(0,r.jsx)("option",{value:"outside",children:"Outside Dhaka"})]}),(0,r.jsx)("select",{name:"payment",defaultValue:A.payment||"cod",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60",children:(0,r.jsx)("option",{value:"cod",children:"Cash on delivery"})}),(0,r.jsx)("textarea",{name:"note",defaultValue:A.note||"",placeholder:"Special note",className:"col-span-2 h-24 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("div",{className:"col-span-2 mt-1 flex items-center justify-end gap-2",children:[(0,r.jsx)("button",{type:"button",className:"rounded-xl border border-black/10 px-3 py-2 dark:border-white/10",onClick:()=>{L(!1),_(null)},children:"Cancel"}),(0,r.jsx)("button",{className:"rounded-xl border border-black/10 bg-black px-3 py-2 text-white dark:border-white/10 dark:bg-white dark:text-black",children:"Save"})]})]})]})]}),(0,r.jsxs)(l,{title:"SEO & Metadata",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("form",{onSubmit:H,className:"rounded-xl border border-black/10 p-3 dark:border-white/10",children:[(0,r.jsx)("h3",{className:"text-sm font-medium",children:"Site defaults"}),(0,r.jsx)("input",{name:"siteTitle",defaultValue:S.siteTitle||"",placeholder:"Site Title",className:"mt-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("textarea",{name:"defaultDescription",defaultValue:S.defaultDescription||"",placeholder:"Default description",className:"mt-2 h-24 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"defaultKeywords",defaultValue:S.defaultKeywords||"",placeholder:"Default keywords (comma separated)",className:"mt-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"ogImage",defaultValue:S.ogImage||"",placeholder:"Default OG image URL",className:"mt-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)("input",{name:"twitterHandle",defaultValue:S.twitterHandle||"",placeholder:"Twitter handle (@...)",className:"mt-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"canonicalBase",defaultValue:S.canonicalBase||"",placeholder:"Canonical base (https://example.com)",className:"mt-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(0,r.jsx)("input",{name:"gaMeasurementId",defaultValue:S.gaMeasurementId||"",placeholder:"GA4 Measurement ID (e.g., G-XXXXXXX)",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"gtmContainerId",defaultValue:S.gtmContainerId||"",placeholder:"GTM Container ID (e.g., GTM-XXXXXX)",className:"rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"})]}),(0,r.jsxs)("label",{className:"mt-2 inline-flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-300",children:[(0,r.jsx)("input",{type:"checkbox",name:"analyticsEnabled",defaultChecked:!1!==S.analyticsEnabled})," Enable analytics scripts"]}),(0,r.jsx)("div",{className:"mt-3 flex justify-end",children:(0,r.jsx)("button",{className:"rounded-xl border border-black/10 bg-black px-3 py-2 text-sm text-white dark:border-white/10 dark:bg-white dark:text-black",children:"Save defaults"})})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-black/10 p-3 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-sm font-medium",children:"Per-path entries"}),(0,r.jsx)("button",{className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",onClick:()=>X(null),children:"Add"})]}),(0,r.jsx)("div",{className:"divide-y divide-black/5 dark:divide-white/10",children:D.map(e=>(0,r.jsxs)("div",{className:"py-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsx)("span",{className:"font-medium",children:e.path})," — ",e.title||"(no title)"]}),(0,r.jsxs)("div",{className:"shrink-0 space-x-2",children:[(0,r.jsx)("button",{className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",onClick:()=>X(e),children:"Edit"}),(0,r.jsx)("button",{className:"rounded-lg border border-red-600/40 px-2 py-1 text-xs text-red-600",onClick:()=>G(e),children:"Delete"})]})]}),e.description&&(0,r.jsx)("div",{className:"mt-1 line-clamp-2 text-xs text-neutral-600 dark:text-neutral-300",children:e.description})]},e._id))})]})]}),O&&(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>{P(!1),I(null)},"aria-hidden":"true"}),(0,r.jsxs)("div",{className:"relative w-[92%] max-w-lg rounded-2xl border border-black/10 bg-white p-5 shadow-2xl dark:border-white/10 dark:bg-neutral-900",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:F?"Edit SEO entry":"Add SEO entry"}),(0,r.jsxs)("form",{onSubmit:K,className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[(0,r.jsx)("input",{name:"path",defaultValue:(null==F?void 0:F.path)||"",placeholder:"Path (e.g., /product/slug)",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"title",defaultValue:(null==F?void 0:F.title)||"",placeholder:"Title",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("textarea",{name:"description",defaultValue:(null==F?void 0:F.description)||"",placeholder:"Description",className:"col-span-2 h-24 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"keywords",defaultValue:(null==F?void 0:F.keywords)||"",placeholder:"Keywords (comma separated)",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"ogImage",defaultValue:(null==F?void 0:F.ogImage)||"",placeholder:"OG image URL",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("input",{name:"canonical",defaultValue:(null==F?void 0:F.canonical)||"",placeholder:"Canonical URL (optional)",className:"col-span-2 rounded-xl border border-black/10 bg-white/70 px-3 py-2 dark:border-white/10 dark:bg-black/60"}),(0,r.jsxs)("label",{className:"col-span-2 flex items-center gap-2 text-xs",children:[(0,r.jsx)("input",{type:"checkbox",name:"noindex",defaultChecked:!!(null==F?void 0:F.noindex)})," Noindex this page"]}),(0,r.jsxs)("div",{className:"col-span-2 mt-1 flex items-center justify-end gap-2",children:[(0,r.jsx)("button",{type:"button",className:"rounded-xl border border-black/10 px-3 py-2 dark:border-white/10",onClick:()=>{P(!1),I(null)},children:"Cancel"}),(0,r.jsx)("button",{className:"rounded-xl border border-black/10 bg-black px-3 py-2 text-white dark:border-white/10 dark:bg-white dark:text-black",children:"Save"})]})]})]})]})]}),(0,r.jsx)(l,{title:"Discord Webhooks",children:(0,r.jsx)(m,{})})]})}function c(e){try{return new Intl.NumberFormat("en-BD").format(Math.round(e))}catch(a){return Math.round(e).toString()}}function b(e){let{data:a=[],height:t=60}=e;if(!a.length)return(0,r.jsx)("svg",{width:"100%",height:t});let d=Math.max(...a),s=Math.min(...a),l=280/Math.max(1,a.length-1),i=a.map((e,a)=>[a*l,d===s?t/2:t-(e-s)/(d-s)*(t-4)-2]).map((e,a)=>0===a?"M".concat(e[0],",").concat(e[1]):"L".concat(e[0],",").concat(e[1])).join(" ");return(0,r.jsx)("svg",{viewBox:"0 0 ".concat(280," ").concat(t),height:t,className:"w-full",children:(0,r.jsx)("path",{d:i,fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.9"})})}function u(){let[e,a]=(0,d.useState)("30d"),[t,s]=(0,d.useState)(!0),[i,n]=(0,d.useState)(null),[o,u]=(0,d.useState)([]),[m,p]=(0,d.useState)({revenue:0,orders:0});async function x(){try{s(!0),n(null);let a=await fetch("/api/admin/sales?range=".concat(e),{cache:"no-store"}),t=await a.json();if(!a.ok)throw Error(t.error||"Failed to load");u(t.daily||[]),p(t.totals||{revenue:0,orders:0})}catch(e){n(e.message)}finally{s(!1)}}(0,d.useEffect)(()=>{x()},[e]);let h=o.map(e=>e.revenue);return(0,r.jsxs)(l,{title:"Sales Overview",children:[(0,r.jsxs)("div",{className:"mb-3 flex items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white/70 p-3 text-sm dark:border-white/10 dark:bg-black/60",children:[(0,r.jsx)("div",{className:"text-xs text-neutral-500",children:"Total revenue"}),(0,r.jsxs)("div",{className:"text-xl font-semibold",children:["৳",c(m.revenue)]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white/70 p-3 text-sm dark:border-white/10 dark:bg-black/60",children:[(0,r.jsx)("div",{className:"text-xs text-neutral-500",children:"Total orders"}),(0,r.jsx)("div",{className:"text-xl font-semibold",children:c(m.orders)})]})]}),(0,r.jsx)("div",{className:"ml-auto",children:(0,r.jsxs)("select",{value:e,onChange:e=>a(e.target.value),className:"rounded-lg border border-black/10 bg-white/70 px-2 py-1 text-sm dark:border-white/10 dark:bg-black/60",children:[(0,r.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,r.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,r.jsx)("option",{value:"90d",children:"Last 90 days"})]})})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-black/10 p-4 dark:border-white/10",children:[i&&(0,r.jsxs)("div",{className:"text-sm text-red-600",children:["Failed to load: ",i]}),t?(0,r.jsx)("div",{className:"h-16 animate-pulse rounded bg-neutral-200/60 dark:bg-neutral-800/60"}):(0,r.jsxs)("div",{className:"text-neutral-600 dark:text-neutral-300",children:[(0,r.jsx)(b,{data:h,height:64}),(0,r.jsx)("div",{className:"mt-2 text-xs",children:"Daily revenue (৳)"})]})]})]})}function m(){let[e,a]=(0,d.useState)(!0),[t,s]=(0,d.useState)(null),[l,i]=(0,d.useState)([]),[n,o]=(0,d.useState)("");async function c(){try{var e;a(!0),s(null);let t=await fetch("/api/admin/site-settings",{cache:"no-store"}),r=await t.json();i((null==r||null==(e=r.settings)?void 0:e.discordWebhooks)||[])}catch(e){s("Failed to load")}finally{a(!1)}}async function b(e){a(!0),(await fetch("/api/admin/site-settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({discordWebhooks:e})})).ok&&(i(e),o("")),a(!1)}async function u(){let e=n.trim();return!function(e){try{let a=new URL(e);return a.hostname.includes("discord.com")&&a.pathname.includes("/api/webhooks/")}catch(e){return!1}}(e)?void alert("Please paste a valid Discord webhook URL"):l.includes(e)?void alert("This webhook is already added"):void await b([...l,e])}async function m(e){confirm("Remove this webhook?")&&await b(l.filter(a=>a!==e))}async function p(e){let a=await fetch("/api/admin/webhooks/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e?{url:e}:{})});a.ok?alert("Test message sent to Discord"):alert("Failed to send: "+((await a.json().catch(()=>({}))).error||a.statusText))}return(0,d.useEffect)(()=>{c()},[]),(0,r.jsxs)("div",{className:"grid gap-3",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-black/10 p-3 dark:border-white/10",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Add a Discord webhook"}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,r.jsx)("input",{value:n,onChange:e=>o(e.target.value),placeholder:"Paste Discord webhook URL",className:"flex-1 rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60"}),(0,r.jsx)("button",{onClick:u,className:"rounded-xl border border-black/10 bg-white px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:"Add"}),(0,r.jsx)("button",{onClick:()=>p(),className:"rounded-xl border border-black/10 bg-white px-3 py-2 text-sm dark:border-white/10 dark:bg-black/60",children:"Send test to all"})]}),(0,r.jsx)("p",{className:"mt-1 text-xs text-neutral-600 dark:text-neutral-400",children:"Tip: In Discord, go to Server Settings → Integrations → Webhooks → New Webhook, then copy the URL."})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-black/10 p-3 text-sm dark:border-white/10",children:[(0,r.jsx)("div",{className:"mb-2 font-medium",children:"Configured webhooks"}),e?(0,r.jsx)("div",{className:"h-10 animate-pulse rounded bg-neutral-200/60 dark:bg-neutral-800/60"}):0===l.length?(0,r.jsx)("div",{className:"text-neutral-500",children:"None added yet."}):(0,r.jsx)("div",{className:"grid gap-2",children:l.map((e,a)=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-black/10 px-3 py-2 dark:border-white/10",children:[(0,r.jsx)("div",{className:"truncate",children:e}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>{var a;return null==(a=navigator.clipboard)?void 0:a.writeText(e)},className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",children:"Copy"}),(0,r.jsx)("button",{onClick:()=>p(e),className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",children:"Test"}),(0,r.jsx)("button",{onClick:()=>m(e),className:"rounded-lg border border-red-200 px-2 py-1 text-xs text-red-600",children:"Remove"})]})]},a))})]})]})}function p(){let[e,a]=(0,d.useState)("pending"),[t,s]=(0,d.useState)([]),[l,i]=(0,d.useState)(!0);async function n(){i(!0);let a=await fetch("/api/admin/reviews?status=".concat(e),{cache:"no-store"});s((await a.json()).reviews||[]),i(!1)}async function o(e,a){await fetch("/api/admin/reviews",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,approved:a})}),n()}async function c(e){confirm("Delete this review?")&&(await fetch("/api/admin/reviews",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),n())}return(0,d.useEffect)(()=>{n()},[e]),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>a("pending"),className:"rounded-lg border px-2 py-1 text-sm ".concat("pending"===e?"bg-black text-white dark:bg-white dark:text-black":""),children:"Pending"}),(0,r.jsx)("button",{onClick:()=>a("approved"),className:"rounded-lg border px-2 py-1 text-sm ".concat("approved"===e?"bg-black text-white dark:bg-white dark:text-black":""),children:"Approved"})]}),l?(0,r.jsx)("div",{className:"h-12 animate-pulse rounded bg-neutral-200/60 dark:bg-neutral-800/60"}):(0,r.jsxs)("div",{className:"divide-y divide-black/5 text-sm dark:divide-white/10",children:[t.map(a=>(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"font-medium",children:[a.name||"Anonymous"," — ",a.rating,"★"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["pending"===e?(0,r.jsx)("button",{onClick:()=>o(a._id,!0),className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",children:"Approve"}):(0,r.jsx)("button",{onClick:()=>o(a._id,!1),className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",children:"Unapprove"}),(0,r.jsx)("button",{onClick:()=>c(a._id),className:"rounded-lg border border-red-200 px-2 py-1 text-xs text-red-600",children:"Delete"})]})]}),(0,r.jsxs)("div",{className:"mt-1 text-xs text-neutral-600 dark:text-neutral-400",children:["Product ID: ",a.productId]}),a.text&&(0,r.jsx)("div",{className:"mt-1 whitespace-pre-wrap",children:a.text})]},a._id)),0===t.length&&(0,r.jsx)("div",{className:"py-6 text-center text-neutral-500",children:"No entries."})]})]})}function x(){let[e,a]=(0,d.useState)("pending"),[t,s]=(0,d.useState)([]),[l,i]=(0,d.useState)(!0),[n,o]=(0,d.useState)({});async function c(){i(!0);let a=await fetch("/api/admin/questions?status=".concat(e),{cache:"no-store"});s((await a.json()).questions||[]),i(!1)}async function b(e,a){await fetch("/api/admin/questions",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,approved:a,answer:n[e]||void 0})}),c()}async function u(e){confirm("Delete this question?")&&(await fetch("/api/admin/questions",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),c())}return(0,d.useEffect)(()=>{c()},[e]),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>a("pending"),className:"rounded-lg border px-2 py-1 text-sm ".concat("pending"===e?"bg-black text-white dark:bg-white dark:text-black":""),children:"Pending"}),(0,r.jsx)("button",{onClick:()=>a("approved"),className:"rounded-lg border px-2 py-1 text-sm ".concat("approved"===e?"bg-black text-white dark:bg-white dark:text-black":""),children:"Approved"})]}),l?(0,r.jsx)("div",{className:"h-12 animate-pulse rounded bg-neutral-200/60 dark:bg-neutral-800/60"}):(0,r.jsxs)("div",{className:"divide-y divide-black/5 text-sm dark:divide-white/10",children:[t.map(e=>(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.name||"Anonymous"," asked"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>b(e._id,!0),className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>b(e._id,!1),className:"rounded-lg border border-black/10 px-2 py-1 text-xs dark:border-white/10",children:"Unapprove"}),(0,r.jsx)("button",{onClick:()=>u(e._id),className:"rounded-lg border border-red-200 px-2 py-1 text-xs text-red-600",children:"Delete"})]})]}),(0,r.jsx)("div",{className:"mt-1 whitespace-pre-wrap",children:e.text}),(0,r.jsx)("textarea",{placeholder:"Answer (optional)",defaultValue:e.answer||"",onChange:a=>o(t=>({...t,[e._id]:a.target.value})),className:"mt-2 w-full rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-xs dark:border-white/10 dark:bg-black/60"})]},e._id)),0===t.length&&(0,r.jsx)("div",{className:"py-6 text-center text-neutral-500",children:"No entries."})]})]})}}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=4050)),_N_E=e.O()}]);